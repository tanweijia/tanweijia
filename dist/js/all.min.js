"use strict";function randomNum(e,t){return parseInt(Math.random()*(t-e+1))+e}function getid(e){return document.getElementById(e)}function filterTex(e){for(var t=["傻B","妈蛋","bitch","fuck","操","小学生","反清复明"],n=0;n<t.length;n++){var a=new RegExp(t[n],"gi");e=e.replace(a,"**")}return e}function randomColor(e){if(16==e){e="0123456789abcdef";for(var t="#",n=0;n<6;n++)t+=e.charAt(parseInt(Math.random()*e.length));return t}if("rgb"==e)return"rgb("+parseInt(256*Math.random())+","+parseInt(256*Math.random())+","+parseInt(256*Math.random())+")";alert("参数传错了")}function setDb(e){return e<10?"0"+e:""+e}function setTime(e){return{sec:setDb(e%60),min:setDb(Math.floor(e/60)%60),hour:setDb(Math.floor(e/60/60)%24),day:Math.floor(e/60/60/24)}}function strToObj(e){for(var t=e.split("&"),n={},a=0;a<t.length;a++){var i=t[a].split("=");n[i[0]]=i[1]}return n}function objToStr(e){var t="";for(var n in e)t+=n+"="+e[n]+"&";return t=t.slice(0,-1)}function getSearch(e,t){var n=strToObj(decodeURI(e).slice(1));for(var a in n){if(n[a]!=n[t])return;return n[a]}}function bind(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function getstyle(e,t){return window.getComputedStyle?getComputedStyle(e,!1)[t]:e.currentStyle?e.currentStyle[t]:e.style[t]}function startMove(i,l,o){clearInterval(i.timer),i.timer=setInterval(function(){var e=!0;for(var t in l){var n=0;n="opacity"==t?100*getstyle(i,t):parseInt(getstyle(i,t));var a=(l[t]-n)/6;a=0<a?Math.ceil(a):Math.floor(a),e=n==l[t],"opacity"==t?(i.style.opacity=(n+a)/100,i.style.filter="alpha(opacity:"+(n+a)+")"):i.style[t]=n+a+"px"}e&&(clearInterval(i.timer),o&&o())},30)}$(function(){$(".sendcity").kuCity(),function(){var e=$("#topbanner .view li").eq(0).outerWidth();$("#topbanner .view li").css("left",e),$("#topbanner .view li").eq(0).css("left",0);var t=null;clearInterval(t);var n=0;function a(){$("#topbanner .view li").eq(n).animate({left:-e},300),n=++n>=$("#topbanner .view li").size()?0:n,$("#topbanner .view li").eq(n).css("left",e),$("#topbanner .view li").eq(n).animate({left:0},300)}t=setInterval(a,3e3),$("#topbanner").hover(function(){clearInterval(t)},function(){clearInterval(t),t=setInterval(a,3e3)})}(),$(".search input").on("focus",function(){$(this).val("")}),$(".search input").on("blur",function(){$(this).val("褚橙优级果138元10斤")});var e,t,n=document.getElementById("go_top");function a(){confirm("亲爱的，您确定要退出本来生活吗？")&&($("#unlogin").css("display","block"),$("#loginAndOut").css("display","none"),$(".loginUname.innerHTML").html(""),$("#my_nickname .login").css("display","block"),$("#my_nickname .return").css("display","none"),$("#my_nickname .returnUname").html(""),$("#go_cart").html("0"),$("#HeaderCartCount").html("0"),$("#cartListView ul").css("display","none"),Cookie.remove("uname"),Cookie.remove("upwd"))}e=n,window.onscroll=function(){200<=window.scrollY?e.style.display="block":window.scrollY<200&&(e.style.display="none")},e.onclick=function(){clearInterval(t),t=setInterval(function(){var e=window.scrollY;e<=0&&(e=0,clearInterval(t)),e-=20,window.scrollTo(0,e)},1)},$("#three_code").click(function(){$("#threecodeParent").toggle()}),function(){var e=document.querySelector("#unlogin"),t=document.querySelector("#loginAndOut"),n=document.querySelector(".loginUname");if(console.log(document.cookie),Cookie.get("uname"))e.style.display="none",t.style.display="block",n.innerHTML=Cookie.get("uname"),$("#my_nickname .login").css("display","none"),$("#my_nickname .return").css("display","block"),$("#my_nickname .returnUname").html(Cookie.get("uname")),console.log("cookie");else if(getSearch(location.search,"uname")){var a=getSearch(location.search,"uname");e.style.display="none",t.style.display="block",n.innerHTML=a,$("#my_nickname .login").css("display","none"),$("#my_nickname .return").css("display","block"),$("#my_nickname .returnUname").html(a),console.log("url")}else e.style.display="block",t.style.display="none",n.innerHTML="",$("#my_nickname .login").css("display","block"),$("#my_nickname .return").css("display","none"),$("#my_nickname .returnUname").html("")}(),$("#loginAndOut a").click(function(){a()}),$(".return a").click(function(){a()})}),$(function(){function u(){var e=$(".piece_num").html(),t=$(".total_text").html(),n=$(".calBtn a");0!=t&&0!=e?n.hasClass("btn_sty")||n.addClass("btn_sty"):n.hasClass("btn_sty")&&n.removeClass("btn_sty")}$("h1").on("click",function(){location.href="../index.html"}),autoCar("../",function(e){$(".car_none").css("display","none"),$(".car_have").css("display","block"),$(".order_content").html("");var i=0,t=e.adminlist.map(function(e){var t=e.imgurl1,n=e.qty*e.cutprice,a=(i=++i)-1;return'<ul class="order_lists" data-id="'+e.goodsid+'">\n                        <li class="list_chk">\n                            <input type="checkbox" id="checkbox_'+a+'" class="son_check">\n                            <label for="checkbox_'+a+'"></label>\n                        </li>\n                        <li class="list_con">\n                            <div class="list_img"><a href="javascript:;"><img src="'+t+'" alt=""></a></div>\n                            <div class="list_text"><a href="javascript:;">'+e.name+'</a></div>\n                        </li>\n                        <li class="list_info">\n                            <p>商品id号：blsh'+e.goodsid+"</p>\n                            <p>商品追加时间："+e.timer+'</p>\n                        </li>\n                        <li class="list_price">\n                        <p class="price">￥<span>'+e.cutprice+'</span></p>\n                        </li>\n                        <li class="list_amount">\n                            <div class="amount_box">\n                                <a href="javascript:;" class="reduce reSty">-</a>\n                                <input type="text" value="'+e.qty+'" class="sum">\n                                <a href="javascript:;" class="plus">+</a>\n                            </div>\n                        </li>\n                        <li class="list_sum">\n                        <p class="sum_price">￥ <span class="sum_idprice">'+n.toFixed(2)+'</span></p>\n                        </li>\n                        <li class="list_op">\n                            <p class="del"><a href="javascript:;" class="delBtn">移除商品</a></p>\n                        </li>\n                    </ul>'}).join("");$(".order_content").html(t)},function(){$(".car_none").css("display","block"),$(".car_have").css("display","none")},function(){$(".car_none").css("display","block"),$(".car_have").css("display","none")}),$(".car_have").on("click","input",function(){$(this).is(":checked")?$(this).next("label").addClass("mark"):$(this).next("label").removeClass("mark")}),$(".car_have").on("click",".whole_check",function(){if($(this).is(":checked")){$(this).prop("checked","checked"),$(this).next("label").addClass("mark"),$(this).parent().parent().parent().next(".cartBox").find(".son_check").prop("checked","checked"),$(this).parent().parent().parent().next(".cartBox").find("label").addClass("mark"),$(".whole_check2").prop("checked","checked"),$(".whole_check2").next().addClass("mark");for(var e=$(this).parent().parent().parent().next(".cartBox").find(".sum"),t=0,n=0;n<e.length;n++)t+=Number(e[n].value);$(".piece_num").html(t);var a=$(this).parent().parent().parent().next(".cartBox").find(".sum_idprice"),i=0;for(n=0;n<a.length;n++)i+=Number(a[n].innerHTML);$(".total_text").html(i.toFixed(2))}else $(this).removeAttr("checked"),$(this).next("label").removeClass("mark"),$(this).parent().parent().parent().next(".cartBox").find(".son_check").removeAttr("checked"),$(this).parent().parent().parent().next(".cartBox").find("label").removeClass("mark"),$(".whole_check2").removeAttr("checked"),$(".whole_check2").next().removeClass("mark"),$(".piece_num").html(0),$(".total_text").html(0);u()}),$(".car_have").on("click",".whole_check2",function(){if($(this).is(":checked")){$(this).prop("checked","checked"),$(this).next("label").addClass("mark"),$(this).parent().parent().parent().prev(".cartBox").find(".son_check").prop("checked","checked"),$(this).parent().parent().parent().prev(".cartBox").find("label").addClass("mark"),$(".whole_check").prop("checked","checked"),$(".whole_check").next().addClass("mark");for(var e=$(this).parent().parent().parent().prev(".cartBox").find(".sum"),t=0,n=0;n<e.length;n++)t+=Number(e[n].value);$(".piece_num").html(t);var a=$(this).parent().parent().parent().prev(".cartBox").find(".sum_idprice"),i=0;for(n=0;n<a.length;n++)i+=Number(a[n].innerHTML);$(".total_text").html(i.toFixed(2))}else $(this).removeAttr("checked"),$(this).next("label").removeClass("mark"),$(this).parent().parent().parent().prev(".cartBox").find(".son_check").removeAttr("checked"),$(this).parent().parent().parent().prev(".cartBox").find("label").removeClass("mark"),$(".whole_check").removeAttr("checked"),$(".whole_check").next().removeClass("mark"),$(".piece_num").html(0),$(".total_text").html(0);u()}),$(".cartBox").on("click","input",function(){var e=1*$(".piece_num").html(),t=1*$(".total_text").html(),n=1*$(this).parent().parent().find(".sum").val(),a=1*$(this).parent().parent().find(".sum_idprice").html();if($(this).is(":checked")){$(this).prop("checked","checked"),$(this).next("label").addClass("mark");var i=$(this).parent().parent().parent().find(".mark"),l=$(this).parent().parent().parent().find("label");$(".piece_num").html(e+n),$(".total_text").html((t+a).toFixed(2)),i.length==l.length?($(".whole_check").prop("checked","checked"),$(".whole_check").next().addClass("mark"),$(".whole_check2").prop("checked","checked"),$(".whole_check2").next().addClass("mark")):($(".whole_check").removeAttr("checked"),$(".whole_check").next().removeClass("mark"),$(".whole_check2").removeAttr("checked"),$(".whole_check2").next().removeClass("mark"))}else $(this).removeAttr("checked"),$(this).next("label").removeClass("mark"),$(".whole_check").removeAttr("checked"),$(".whole_check").next().removeClass("mark"),$(".whole_check2").removeAttr("checked"),$(".whole_check2").next().removeClass("mark"),$(".piece_num").html(e-n),$(".total_text").html((t-a).toFixed(2));u()}),$(".cartBox").on("click",".plus",function(){if($(this).parent().parent().parent().find(".son_check").is(":checked"))var e=0,t=0;else e=1*$(this).prev().val(),t=1*$(this).parent().parent().parent().find(".sum_idprice").html();var n=$(this).prev().val();100<=++n&&(n=100),$(this).prev().val(n),$(this).parent().parent().parent().find(".son_check").prop("checked","checked"),$(this).parent().parent().parent().find("label").addClass("mark");var a=1*$(this).prev().val(),i=1*$(this).parent().parent().parent().find(".price span").html(),l=a*i;$(this).parent().parent().parent().find(".sum_idprice").html(l.toFixed(2));var o=1*$(".piece_num").html(),r=1*$(".total_text").html();$(".piece_num").html(o+e+1),$(".total_text").html((r+t+i).toFixed(2));var c=$(this).parent().parent().parent().parent().find(".mark"),s=$(this).parent().parent().parent().parent().find("label");c.length==s.length?($(".whole_check").prop("checked","checked"),$(".whole_check").next().addClass("mark"),$(".whole_check2").prop("checked","checked"),$(".whole_check2").next().addClass("mark")):($(".whole_check").removeAttr("checked"),$(".whole_check").next().removeClass("mark"),$(".whole_check2").removeAttr("checked"),$(".whole_check2").next().removeClass("mark")),u();var d=Cookie.get("uname"),p=$(this).parent().parent().parent().data("id");$.ajax({type:"POST",url:"../api/car.php",data:"admin="+d+"&goodsid="+p+"&addqty=1",success:function(e){console.log("数据库 增加 修改成功")}})}),$(".cartBox").on("click",".reduce",function(){var e=1*$(".piece_num").html(),t=1*$(".total_text").html(),n=1*$(this).parent().parent().parent().find(".price span").html(),a=$(this).parent().parent().parent().find(".son_check").is(":checked");jianno_sum_qty=e+1,jianno_sum_price=t+n;var i=1*$(this).next().val(),l=i;--i<=1&&(i=1),$(this).next().val(i);var o=1*$(this).next().val(),r=o*n;$(this).parent().parent().parent().find(".sum_idprice").html(r.toFixed(2)),a?1<i?($(".piece_num").html(e-1),$(".total_text").html((t-n).toFixed(2))):2==l?($(".piece_num").html(e-1),$(".total_text").html((t-n).toFixed(2))):(jian_sum_qty=e-1,$(".piece_num").html(e),$(".total_text").html(t.toFixed(2))):1<i?($(".piece_num").html(e+o),$(".total_text").html((t+r).toFixed(2))):($(".piece_num").html(jianno_sum_qty),$(".total_text").html(jianno_sum_price.toFixed(2))),$(this).parent().parent().parent().find(".son_check").prop("checked","checked"),$(this).parent().parent().parent().find("label").addClass("mark");var c=$(this).parent().parent().parent().parent().find(".mark"),s=$(this).parent().parent().parent().parent().find("label");c.length==s.length?($(".whole_check").prop("checked","checked"),$(".whole_check").next().addClass("mark"),$(".whole_check2").prop("checked","checked"),$(".whole_check2").next().addClass("mark")):($(".whole_check").removeAttr("checked"),$(".whole_check").next().removeClass("mark"),$(".whole_check2").removeAttr("checked"),$(".whole_check2").next().removeClass("mark")),u();var d=Cookie.get("uname"),p=$(this).parent().parent().parent().data("id");console.log(l),$.ajax({type:"POST",url:"../api/car.php",data:"admin="+d+"&goodsid="+p+"&addqty="+-1+"&valKeepqty="+l,success:function(e){console.log("数据库减 数量 修改成功")}})});var i=!1,l=null,o=null,r=null,c=null,s=null;function d(){$(".model_bg").fadeOut(300),$(".my_model").fadeOut(300)}$(".order_content").on("click",".delBtn",function(){l=$(this).parent().parent().parent(),s=$(this).parent().parent().parent().parent().find("ul").size(),c=$(this).parent().parent().parent().data("id"),console.log(c),$(this).parent().parent().parent().find(".son_check").is(":checked")&&(i=!0,o=1*$(this).parent().parent().parent().find(".amount_box").find("input").val(),r=1*$(this).parent().parent().parent().find(".sum_idprice").html()),$(".model_bg").fadeIn(300),$(".my_model").fadeIn(300)}),$(".closeModel").click(function(){d()}),$(".dialog-close").click(function(){d()}),$(".dialog-sure").click(function(){l.remove();var e=1*$(".piece_num").html(),t=1*$(".total_text").html();i&&($(".piece_num").html(e-o),$(".total_text").html((t-r).toFixed(2))),1==s&&($(".car_have").css("display","none"),$(".car_none").css("display","block")),d();var n=Cookie.get("uname"),a=c;$.ajax({type:"POST",url:"../api/car_delete.php",data:"admin="+n+"&goodsid="+a+"&deleteall=0",success:function(e){console.log(e)}})})});var checkReg={trim:function(e){return e.replace(/^\s+|\s+$/g,"")},tel:function(e){return/^1[3-9]\d{9}$/.test(e)},email:function(e){return/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e)},idcard:function(e){return/^(\d{17}|\d{14})[\dX]$/.test(e)},psweasy:function(e){return/((?=.*\d)(?=.*\D)|(?=.*[a-zA-Z])(?=.*[^a-zA-Z]))(?!^.*[\u4E00-\u9FA5].*$)^\S{6,16}$/.test(e)},pwwagain:function(e,t){return e===t},urladr:function(e){return/[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?/.test(e)},name:function(e){return/^[a-zA-Z][\w\-]{5,19}$/.test(e)},chinese:function(e){return/^[\u2E80-\u9FFF]+$/.test(e)}},Cookie={set:function(e,t,n){var a=e+"="+t;n&&(n.expires&&(a+=";expires="+n.expires.toUTCString()),n.path&&(a+=";path="+n.path),n.domain&&(a+=";domain="+n.domain)),document.cookie=a},get:function(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var a=t[n].split("=");if(e==a[0])return a[1]}},remove:function(e){var t=new Date;t.setDate(t.getDate()-1),this.set(e,"no",{expires:t,path:"/"})}};function backTop(t,e,n){n=n||30,window.onscroll=function(){var e=window.scrollY;t.style.display=300<=e?"block":"none"},t.onclick="fast"===e?function(){window.scrollTo(0,0)}:function(){var t=setInterval(function(){var e=window.scrollY;0<e?window.scrollTo(0,e-20):clearInterval(t)},n)}}function pullDownMenu(e,t){var n=document.getElementById(e).children;if("onmouseout"==t||"onmouseover"==t)for(var a=0;a<n.length;a++)n[a].onmouseover=function(){this.children[0].style.display="block"},n[a].onmouseout=function(){this.children[0].style.display="none"};if("onclick"==t)for(a=0;a<n.length;a++)n[a].idx=a,n[a].istrue=!0,n[a].onclick=function(){this.istrue?this.children[0].style.display="block":this.children[0].style.display="none",this.istrue=!this.istrue}}function setTab(e,t){var n=document.getElementById(e),a=n.children[0].children,i=n.children[1].children;a[0].className=t,i[0].style.display="block";for(var l=0;l<a.length;l++)a[l].idx=l,a[l].onclick=function(){for(var e=0;e<a.length;e++)a[e].className="",i[e].style.display="none";this.className=t,i[this.idx].style.display="block"}}function sidebar(e,t,n){var a=document.getElementById(e),i=a.offsetWidth;if(console.log(i),"onmouseout"!=n&&"onmouseover"!=n||(a.onmouseenter=function(){startMove(a,"left"==t?{left:0}:{right:0})},a.onmouseleave=function(){startMove(a,"left"==t?{left:-i}:{right:-i})}),"onclick"==n){var l=!0;a.onclick=function(){startMove(a,l?"left"==t?{left:0}:{right:0}:"left"==t?{left:-i}:{right:-i}),l=!l}}}function autoCar(n,a,e,t){var i=0;if(Cookie.get("uname")){var l=Cookie.get("uname");console.log(l),$.ajax({type:"POST",url:n+"api/carShowNunfrist_select.php",data:"admin="+l,success:function(e){var t=JSON.parse(e);console.log("用户历史进购物车清单"),console.log(t.adminlist),console.log(Array.isArray(t.adminlist)),t.adminlist?(t.adminlist.map(function(e){i+=Number(e.qty)}),$("#HeaderCartCount").html(i),$("#go_cart").html(i),$("#cartListView .buy").css("display","block"),$("#cartListView .none_car").css("display","none"),creatAddMycar(t,n),$("#carListTotalCount").html(i),a&&a(t)):(i=0,$("#HeaderCartCount").html(0),$("#go_cart").html(0),$("#cartListView ul").html(""),$("#cartListView .buy").css("display","none"),$("#cartListView .none_car").css("display","block"),fnno&&fnno())}})}else $("#HeaderCartCount").html(0),$("#go_cart").html(0),$("#cartListView ul").html(""),$("#cartListView .buy").css("display","none"),$("#cartListView .none_car").css("display","block"),t&&t()}function creatAddMycar(e,n){$("#cartListView ul").html("");var a=0,t=e.adminlist.map(function(e){var t=e.imgurl1;return a+=e.cutprice*e.qty,t=n?e.imgurl1:t.slice(3),'<li data-id="'+e.goodsid+'">\n                    <div class="pic">\n                        <a href="" target="_blank" title="'+e.name+'">\n                        <img src="'+t+'"></a>\n                    </div>\n                    <div class="name">\n                        <a href="" target="_blank" title="'+e.name+'">'+e.name+'\n                        <span></span></a>\n                    </div>\n                    <div class="price">￥'+e.cutprice+'</div>\n                    <div class="talqty"><span>×</span>'+e.qty+"</div>\n                </li>"}).join("");console.log(a.toFixed(2)),$("#cartListView ul").html(t),$("#carListTotalCount").next().html(a.toFixed(2))}function creatAddCarSide(e,t,n){$("#item_add").html("");var a='<li class="b0">\n                    <div class="pic">\n                        <img src="'+e.imgurl1+'">\n                    </div>\n                    <div class="name">'+e.name+"<br>\n                        <span>X "+t+' 加入成功</span>\n                    </div>\n                    <div class="price">￥'+e.cutprice+"</div>\n                </li>";$("#item_add").html(a),$("#go_cart").html(n),$("#HeaderCartCount").html(n),$(".new_car").css({right:"-250px",display:"block"}),$(".new_car").animate({right:"52px",display:"block"},1e3),$(".car_buy").addClass("move"),$(".new_car").animate({right:"52px",display:"block"},1500,function(){$(".car_buy").removeClass("move")}),$(".new_car").animate({right:"-350px",display:"none"},"slow")}function sliderImg(e,t){for(var n=getid(e),a=n.children[0].children[0].children,i=a[0].offsetWidth,l=0,o=n.children[1].children,r=n.children[2],c=r.children[0],s=r.children[1],d=0;d<a.length;d++)a[d].style.left=i+"px";a[0].style.left=0;var p=null;function u(){startMove(a[l],{left:-i}),l=++l>=a.length?0:l,a[l].style.left=i+"px",startMove(a[l],{left:0}),m()}function m(){for(var e=0;e<o.length;e++)o[e].className="";o[l].className=t}clearInterval(p),p=setInterval(u,3500),c.style.display="none",s.style.display="none",n.onmouseenter=function(){clearInterval(p),c.style.display="block",s.style.display="block"},n.onmouseleave=function(){clearInterval(p),p=setInterval(u,3500),c.style.display="none",s.style.display="none"},c.onclick=function(){startMove(a[l],{left:i}),l=--l<0?a.length-1:l,a[l].style.left=-i+"px",startMove(a[l],{left:0}),m()},s.onclick=function(){u()};for(d=0;d<o.length;d++)o[d].index=d,o[d].onclick=function(){var e=this.index;l<e&&(startMove(a[l],{left:-i}),a[e].style.left=i+"px",startMove(a[e],{left:0}),l=e,m()),e<l&&(startMove(a[l],{left:i}),a[e].style.left=-i+"px",startMove(a[e],{left:0}),l=e,m())}}$(function(){var e;autoCar("../"),$(".nav_y").on("click",function(){location.href="list.html"}),$("h1").on("click",function(){location.href="../index.html"}),e=getSearch(location.search,"goodsid"),console.log(e),$.ajax({type:"GET",url:"../api/list_select.php?goodsid="+e+"&time=new Date()",success:function(e){var t=JSON.parse(e),n=t.goodsid[0];console.log("对应商品id详细信息"),console.log(n);for(var a=[n.imgurl1,n.imgurl2,n.imgurl3,n.imgurl1,n.imgurl2,n.imgurl3],i=[n.imgurl1,n.imgurl2,n.imgurl3,n.imgurl1,n.imgurl2,n.imgurl3],l="",o=0;o<a.length;o++)l+='<li><img src="'+a[o]+'" data-lsrc="'+a[o]+'" data-maxSrc="'+i[o]+'"></li>';$("#MagnifierWrap2 .spec-items ul").html(l),$("#MagnifierWrap2 .spec-items ul li").eq(0).addClass("on");var r='<img class="MagTargetImg" src="'+a[0]+'" data-src="'+i[0]+'">';$("#MagnifierWrap2 .MagnifierMain").html(r),MagnifierF("MagnifierWrap2");var c=n.name+"<span>"+n.title+"</span>";$(".goodsinfval h2").html(c),$(".goodsinfval .cutprice").html(n.cutprice),$(".goodsinfval .oldprice").html(n.oldprice),$(".goodsinfval .sellqty").html(n.sellqty),$(".goodsinfval .commentqty").html(n.comment)}}),$(".changeqty").on("click",".jian",function(){var e=$(this).parent().find("input").val();--e<=1&&(e=1),$(this).parent().find("input").val(e)}),$(".changeqty").on("click",".jia",function(){var e=$(this).prev().val();100<=++e&&(e=100),$(this).prev().val(e)}),$(".goodsinfval").on("click",".buy_btn_detail",function(){console.log("buy_btn_detail");var e=Cookie.get("uname"),t=getSearch(location.search,"goodsid"),a=$(this).prev().find("input").val();$.ajax({type:"POST",url:"../api/car.php",data:"admin="+e+"&goodsid="+t+"&addqty="+a,success:function(e){var t=JSON.parse(e);console.log(e),console.log(t),console.log(t.adminlist),console.log(Array.isArray(t.adminlist));var n=0;t.adminlist?t.adminlist.map(function(e){n+=Number(e.qty)}):n=0,creatAddMycar(t),creatAddCarSide(t,a,n)}})})}),function(e,c){var s,d,t=e.html5||{},i=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,l=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,n="_html5shiv",a=0,o={};function p(){var e=h.elements;return"string"==typeof e?e.split(" "):e}function u(e){var t=o[e[n]];return t||(t={},a++,e[n]=a,o[a]=t),t}function m(e,t,n){return t||(t=c),d?t.createElement(e):(n||(n=u(t)),(a=n.cache[e]?n.cache[e].cloneNode():l.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e)).canHaveChildren&&!i.test(e)?n.frag.appendChild(a):a);var a}function r(e){e||(e=c);var t,n,a,i,l,o,r=u(e);return!h.shivCSS||s||r.hasCSS||(r.hasCSS=(n="article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}",a=(t=e).createElement("p"),i=t.getElementsByTagName("head")[0]||t.documentElement,a.innerHTML="x<style>"+n+"</style>",!!i.insertBefore(a.lastChild,i.firstChild))),d||(l=e,(o=r).cache||(o.cache={},o.createElem=l.createElement,o.createFrag=l.createDocumentFragment,o.frag=o.createFrag()),l.createElement=function(e){return h.shivMethods?m(e,l,o):o.createElem(e)},l.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+p().join().replace(/[\w\-]+/g,function(e){return o.createElem(e),o.frag.createElement(e),'c("'+e+'")'})+");return n}")(h,o.frag)),e}!function(){try{var e=c.createElement("a");e.innerHTML="<xyz></xyz>",s="hidden"in e,d=1==e.childNodes.length||function(){c.createElement("a");var e=c.createDocumentFragment();return void 0===e.cloneNode||void 0===e.createDocumentFragment||void 0===e.createElement}()}catch(e){d=s=!0}}();var h={elements:t.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==t.shivCSS,supportsUnknownElements:d,shivMethods:!1!==t.shivMethods,type:"default",shivDocument:r,createElement:m,createDocumentFragment:function(e,t){if(e||(e=c),d)return e.createDocumentFragment();for(var n=(t=t||u(e)).frag.cloneNode(),a=0,i=p(),l=i.length;a<l;a++)n.createElement(i[a]);return n}};e.html5=h,r(c)}(void 0,document),$(function(){autoCar(""),$(".nav_y").on("click",function(){location.href="html/list.html"}),$("h1").on("click",function(){console.log(111),location.href="index.html"}),sliderImg("banner","active"),setTab("tabs","active"),setTab("bigbox","active")}),$(function(){autoCar("../"),$(".nav_y").on("click",function(){location.href="list.html"}),$("h1").on("click",function(){location.href="../index.html"});var n=document.querySelector(".list_ku"),i=document.querySelector("#page"),l=document.querySelector("#prev"),o=document.querySelector("#next"),r=0,c="way=asc&key=goodsid";function s(e){n.innerHTML="";var t=e.datalist.map(function(e){return'<li data-id="'+e.goodsid+'">\n                            <div class="box">\n                                <p class="jump pic"><img src="'+e.imgurl1+'"/></p>\n                                <p class="jump name">\n                                    <a href="javascript:;">'+e.name+"</a>\n                                    <span>"+e.title+'</span>\n                                </p>\n                                <p class="price">￥'+e.cutprice+"<span>￥"+e.oldprice+'</span></p>\n                                <p class="qty">\n                                    <a href="javascript:;" class="jian"></a>\n                                    <input type="text" value="1" class="addCarNum"/>\n                                    <a href="javascript:;"javascript:; class="jia"></a>\n                                </p>\n                                <p class="btn"><img src="../images/listAddCar.gif"/></p>\n                            </div>\n                        </li>'}).join("");n.innerHTML=t}var d=new XMLHttpRequest,t="../api/list_select.php?page=1&qty=16&time=new Date()";d.open("GET",t,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=d.responseText,t=JSON.parse(e);console.log(t),s(t);var n=Math.ceil(t.total/t.qty);r=n;for(var a=0;a<n;a++)i.innerHTML+="<span>"+(a+1)+"</span>";i.children[0].className="active",2<=n&&(l.style.display="block",o.style.display="block")}};var a,p=1;i.onclick=function(e){"span"==(e=e||window.event).target.tagName.toLowerCase()&&(p=e.target.innerText,t="../api/list_select.php?page="+p+"&qty=16&time=new Date()&"+c,d.open("GET",t,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=d.responseText;s(JSON.parse(e));for(var t=0;t<i.children.length;t++)i.children[t].className="";i.children[p-1].className="active",clearTimeout(a),a=setTimeout(function(){window.scrollTo(0,0)},1e3)}})},l.onclick=function(){--p<=1&&(p=1);var e="../api/list_select.php?page="+p+"&qty=16&time=new Date()&"+c;d.open("GET",e,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=d.responseText;s(JSON.parse(e));for(var t=0;t<i.children.length;t++)i.children[t].className="";i.children[p-1].className="active",clearTimeout(a),a=setTimeout(function(){window.scrollTo(0,0),console.log(111)},1e3)}}},o.onclick=function(){r<=++p&&(p=r);var e="../api/list_select.php?page="+p+"&qty=16&time=new Date()&"+c;d.open("GET",e,!0),d.send(),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=d.responseText;s(JSON.parse(e));for(var t=0;t<i.children.length;t++)i.children[t].className="";i.children[p-1].className="active",clearTimeout(a),a=setTimeout(function(){window.scrollTo(0,0)},1e3)}}};var u=!0,m=!0,h=!0,f=!0;$(".list_sort").on("click","li",function(){var e,t,n,a;$(".list_sort li a").removeClass("on"),$(".list_sort li span").removeClass("up"),$(".list_sort li span").removeClass("down"),$(this).is(".default")?(e="asc",t="goodsid"):$(this).is(".times")?($(".times a").addClass("on"),t="timer",e=u?($(".times span").addClass("up"),"asc"):($(".times span").addClass("down"),"desc"),u=!u):$(this).is(".sellqty")?($(".sellqty a").addClass("on"),t="sellqty",e=m?($(".sellqty span").addClass("up"),"asc"):($(".sellqty span").addClass("down"),"desc"),m=!m):$(this).is(".price")?($(".price a").addClass("on"),t="cutprice",e=h?($(".price span").addClass("up"),"asc"):($(".price span").addClass("down"),"desc"),h=!h):$(this).is(".comment")&&($(".comment a").addClass("on"),t="sellqty",e=f?($(".comment span").addClass("up"),"asc"):($(".comment span").addClass("down"),"desc"),f=!f),n=e,a=t,$.ajax({type:"GET",url:"../api/list_select.php?page=1&qty=16&way="+n+"&key="+a+"&time=new Date()",success:function(e){var t=JSON.parse(e);console.log(t),s(t)}}),c="way="+e+"&key="+t}),$(".list_ku").on("click",".jian",function(){var e=$(this).next().val();--e<=1&&(e=1),$(this).next().val(e)}),$(".list_ku").on("click",".jia",function(){var e=$(this).prev().val();100<=++e&&(e=100),$(this).prev().val(e)}),$(".list_ku").on("click",".btn",function(){console.log("btn");var e=Cookie.get("uname"),t=$(this).parent().parent().data("id"),a=$(this).parent().find(".addCarNum").val();$.ajax({type:"POST",url:"../api/car.php",data:"admin="+e+"&goodsid="+t+"&addqty="+a,success:function(e){var t=JSON.parse(e);console.log(e),console.log(t),console.log(t.adminlist),console.log(Array.isArray(t.adminlist));var n=0;t.adminlist?t.adminlist.map(function(e){n+=Number(e.qty)}):n=0,creatAddMycar(t,"../"),creatAddCarSide(t,a,n)}})}),$(".list_ku ").on("click",".pic",function(){var e=$(this).parent().parent().data("id");location.href="detail.html?goodsid="+e}),$(".list_ku ").on("click",".name",function(){var e=$(this).parent().parent().data("id");location.href="detail.html?goodsid="+e})}),$(function(){autoCar("../"),$(".nav_y").on("click",function(){location.href="list.html"}),$("h1").on("click",function(){location.href="../index.html"});var l=document.getElementById("phoneTxt"),o=document.getElementById("phoneMes"),r=document.getElementById("pswTxt"),c=document.getElementById("pswMes"),s=document.getElementById("remember_me"),e=document.getElementById("registerBtn");if($("#unlogin").css("display","block"),$("#loginAndOut").css("display","none"),$(".loginUname.innerHTML").html(""),$("#my_nickname .login").css("display","block"),$("#my_nickname .return").css("display","none"),$("#my_nickname .returnUname").html(""),l.onclick=function(){"请输入手机号"==l.value&&(l.value="")},Cookie.get("uname")&&"undefined"!=Cookie.get("uname")){console.log("免登陆");var t=Cookie.get("uname"),n=Cookie.get("upwd");l.value=t,r.value=n}e.onclick=function(e){e.preventDefault();var n=l.value,a=r.value;if(Cookie.get("uname"))l.value==Cookie.get("uname")&&Cookie.get("upwd")&&checkReg.tel(l.value)?(location.href="../index.html",o.innerHTML="",c.innerHTML=""):o.innerHTML="用户名或密码不正确";else if(0!=n.trim().length&&"请输入手机号"!=n||0!=a.trim().length)if(0==a.trim().length)c.innerHTML="请输入密码!",o.innerHTML="";else{var i=new XMLHttpRequest;i.open("POST","../api/login_select.php",!0),i.setRequestHeader("content-type","application/x-www-form-urlencoded");var t="name="+n+"&psw="+a;i.send(t),i.onreadystatechange=function(){if(4==i.readyState&&(200==i.status||304==i.status)){var e=i.responseText;if(console.log(e),"yes"==e){if(s.checked){var t=new Date;t.setDate(t.getDate()+7),document.cookie="uname="+n+"; expires="+t.toUTCString()+"; path=/",document.cookie="upwd="+a+"; expires="+t.toUTCString()+"; path=/"}else document.cookie="uname="+n+"; path=/",document.cookie="upwd="+a+"; path=/";location.href="../index.html",o.innerHTML="",c.innerHTML=""}else c.innerHTML=(o.innerHTML="new"==e?"用户名不存在":"用户名或密码不正确","")}}}else o.innerHTML="账号或密码为空,请重新输入",console.log(666)}}),document.addEventListener("DOMContentLoaded",function(){autoCar("../"),$(".nav_y").on("click",function(){location.href="list.html"}),$("h1").on("click",function(){location.href="../index.html"});var i=document.querySelector("#phoneTxt"),l=document.querySelector("#phoneMes"),o=!1,e=document.querySelector("#registerBtn");i.onclick=function(){"请输入手机号"==i.value&&(i.value="")},i.onblur=function(){var e=i.value,t=checkReg.trim(e);if(""==t)l.innerHTML="",l.style.color="";else if(t&&checkReg.tel(t)){var n=new XMLHttpRequest,a="../api/reg_select.php?phone="+e+"&time="+new Date;n.open("GET",a,!0),n.send(),n.onreadystatechange=function(){4!=n.readyState||200!=n.status&&304!=n.status||("0"==n.responseText?(l.innerHTML='该手机号已被使用，可直接<a href="../html/login.html" style="text-decoration:underline">登录</a>！',l.style.display="block",i.previousElementSibling.className="no"):(l.innerHTML="",i.previousElementSibling.className="yes",o=!0))}}else l.innerHTML="手机号码格式不正确，请重新输入！",l.style.display="block",i.previousElementSibling.className="no"};var t=document.getElementById("codeTxt"),n=document.querySelector("#codeMes"),r=!1;t.onclick=function(){"请输入验证码"==t.value&&(t.value="")};var a=new GVerify("codeBtn");t.onblur=function(){a.validate(t.value)?(n.innerHTML="",r=!0):(n.innerHTML="您输入的验证码有误，请重新输入！",n.style.display="block")};document.querySelector(".chizi");var c=document.querySelector(".fugai"),s=(document.querySelector(".pullX"),!1);0!=c.offsetLeft&&(c.onmousedown=function(e){var e=e||window.event,n=e.clientX-c.offsetLeft;e.preventDefault(),document.onmousemove=function(e){var e=e||window.event,t=e.clientX-n;0<=t&&(t=0,c.onmousedown=null),c.style.left=t+"px"}},s=document.onmouseup=function(e){var e=e||window.event;if(e.preventDefault(),document.onmousemove=null,0!=c.offsetLeft)c.style.left="-246px";else{c.innerHTML='验证通过！<span class="pullStop"></span>';var t=c.lastElementChild}return"pullStop"==t.className?(s=!0,console.log(s)):s=!1,s});var d=document.getElementById("pswTxt"),p=document.querySelector("#pswMes"),u=!1;d.onblur=function(){var e=d.value,t=checkReg.trim(e);""==t?p.innerHTML="":t==i.value?(p.innerHTML="密码不能与手机号码一样",p.style.display="block",d.previousElementSibling.className="no"):t&&checkReg.psweasy(t)?(p.innerHTML="",d.previousElementSibling.className="yes",u=!0):(p.innerHTML="密码须为6-16位字母,数字,半角符号中至少两种组合",p.style.display="block",d.previousElementSibling.className="no")};var m=document.getElementById("psw2Txt"),h=document.querySelector("#psw2Mes"),f=!1;m.onblur=function(){m.value;""==m.value?h.innerHTML="":m.value==d.value?(m.previousElementSibling.className="yes",h.innerHTML="",f=!0):(h.innerHTML="两次输入的密码不一致!",h.style.display="block",m.previousElementSibling.className="no")};var v=document.getElementById("check_agree"),k=document.getElementById("xieyiMes"),g=!1;v.onclick=function(){1==v.checked?(g=!0,e.className=""):(g=!1,e.className="no")},e.onclick=function(){if(g){var e=i.value.trim(),t=d.value.trim();if(o&&s&&r&&u&&f){var n=new XMLHttpRequest;n.open("POST","../api/reg_insert.php",!0),n.setRequestHeader("content-type","application/x-www-form-urlencoded");var a="phone="+e+"&psw="+t;n.send(a),n.onreadystatechange=function(){if(4==n.readyState&&(200==n.status||304==n.status)){var e=n.responseText;console.log(e),"yes"==e?location.href="../html/login.html":alert("注册失败")}}}else alert("注册失败")}else k.style.display="blcok"}});